Rackspace requires a few minor tweaks to create a working image.
It also requires that we use a distinct API binding to upload
the resulting image to the cloud.


Below is an example of creating and uploading an F20 image.

A few notes:

* we use the pnl mirror for the Fedora 20 install media
* we set the root PW but it is changed at boot time by the Rackspace infra
* the upload format for Rackspace is uncompressed - for efficiency we use a 3 GB root disk

(The kickstart and TDL file can be found in this directory)

* Do everything at once - This is the simplest way to do a build.  If you want to see the
details of each step, use the three-step instructions that follow

# imagefactory --debug provider_image --template ./f20-rackspace.tdl \
               --file-parameter install_scipt f20-rackspace.ks \
               --parameter safe_icicle True rackspace @dfw ./rackspace_creds.xml

...
============ Final Image Details ============
UUID: d93bc0d3-70d5-4fb6-a3a9-c8484b1631fd
Type: provider_image
Image filename: /var/lib/imagefactory/storage/d93bc0d3-70d5-4fb6-a3a9-c8484b1631fd.body
Image ID on provider: 3ce00e52-8c54-4f0e-b367-2e9996d5498d
Image build completed SUCCESSFULLY!

The "Image ID on provider" is the UUID generated by Rackspace.  You can look for
this ID when launching an image in the DFW region.


The three individual image builds that make up this process:


* Create the base image using the rackspace-specific kickstart

# imagefactory --debug base_image --file-parameter install_scipt --parameter safe_icicle True \
                f20-rackspace.ks f20-jeos.tdl

...
============ Final Image Details ============
UUID: 1624ccb0-a47f-431d-8f0d-4b6f64a2d36f
Type: base_image
Image filename: /var/lib/imagefactory/storage/1624ccb0-a47f-431d-8f0d-4b6f64a2d36f.body
Image build completed SUCCESSFULLY!

* Create a rackspace target image

# imagefactory --debug target_image --id 1624ccb0-a47f-431d-8f0d-4b6f64a2d36f rackspace

...
============ Final Image Details ============
UUID: 077d7406-6d31-4db9-b9a2-2d5a166b98d2
Type: target_image
Image filename: /var/lib/imagefactory/storage/077d7406-6d31-4db9-b9a2-2d5a166b98d2.body
Image build completed SUCCESSFULLY!

* Upload/push the image to the DFW region

# imagefactory --debug provider_image --id 077d7406-6d31-4db9-b9a2-2d5a166b98d2 rackspace @dfw ./rackspace_creds.xml

(A non-working example of the format of "rackspace_creds.xml" can be found in this directory.)

...
============ Final Image Details ============
UUID: 36f2f8e5-d0f4-453e-8b39-2d966b2b7afe
Type: provider_image
Image filename: /var/lib/imagefactory/storage/36f2f8e5-d0f4-453e-8b39-2d966b2b7afe.body
Image ID on provider: e8b9613d-3e86-459e-bed4-4befc6b3a7c2
Image build completed SUCCESSFULLY!

